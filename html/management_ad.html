<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;" name="viewport"/>
    <title>地址管理</title>

    <!-- Bootstrap -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="http://cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

  </head>
  <body>
 

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="../js/jquery-1.11.2.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="../js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../js/getUrl.js"></script>
    <script src="../js/getcookie.js"></script>
    <script type="text/javascript">
      var user_id=getUrlParam("user_id");
      var commit=getUrlParam("commit");//判断是否由订单页进入，还是从菜单栏进入
      console.log(commit==undefined);
    
      $(document).ready(function(){
          
          if(commit==0){
            $("[class='btn-container text-center']").prepend("<button class=\"btn btn-success\" onclick=\"backCommit()\" style="margin:0px 10px\">返回订单</button>");
          }  //如果从订单页进入，加入返回订单按钮
          var xmlhttp;
           if (window.XMLHttpRequest) {
            xmlhttp = new XMLHttpRequest();
          }else{
             xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
         }
          var url="user_id="+encodeURIComponent(user_id);
          xmlhttp.open("POST","address.php",true);
          xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
          xmlhttp.onreadystatechange = function() {
             
             if (xmlhttp.readyState == 4 && xmlhttp.status == 200){
               var info = xmlhttp.responseText;
                if(info="false"){
                $("body").prepend("<div class=\"empty-box text-center\"><p>暂无收货地址！</p></div>");
              }else{
                var text = eval("("+info+")");
                var content=document.createElement("div");
                content.className="list-group"
                for(var i = 0; i < text.length; i++){
                  var address_id = text[i].address_id;
                  var name=text[i].name;
                  var phone=text[i].phone;
                  var province=text[i].province;
                  var city=text[i].city;
                  var address = text[i].address;
                  var address_detail=name+phone+province+city+address;
                 var content_item=document.createElement("div");
                  content_item.className="list-group-item row";
                  content_item.id=address_id;
                  content.appendChild(content_item);
                  var content_item_body=document.createElement("div");
                  content_item_body.className="col-xs-10 text-left";
                  content_item_body.innerHTML=address_detail;
                  content_item_body.onclick="select(address_id)"
                  if(commit==undefined){
                    $("[class='col-xs-10 text-left']").attr("disable","true");//如果是由菜单栏进入禁用选项，只能编辑不可选择
                  }

                  content_item.appendChild(content_item_body);
                  var content_item_edit=document.createElement("div");
                  content_item_edit.className="col-xs-2";
                  content_item.appendChild(content_item_edit);
                  var edit_v=document.createElement("span");
                  edit_v.className="glyphicon glyphicon-pencil arrow";
                 // edit_v.aria-hidden="true";
                  edit_v.onclick="edit(address_id)"
                  content_item_edit.appendChild(edit_v);

              }
            }
          }
        }
        xmlhttp.send(url);
      })  

      function select(address_id){
        location.href="order_commit.html?user_id="+user_id+"&address_id="+address_id;
      }
      function edit(address_id){
        location.href="address.html?user_id="+user_id+"&address_id="+address_id;
      }
      function addNew(){
        location.href="address.html?user_id="+user_id;
      }
      function backCommit(){
        history.back();
      }

    </script>
 <!-- <div class="list-group">
      <div class="list-group-item row" id="1">
      <div class="col-xs-10 text-left">罗夏君18922326092广东省广州市天河区沙和路164号401</div>
      <div class="col-xs-2"><span class="glyphicon glyphicon-pencil arrow" ></span></div> 
    </div>
    </div>--><!--地址列表样式-->
    <!--<div class="empty-box text-center">
      <p>暂无收货地址!</p>
    </div>-->
    <div class="btn-container text-center">
 <!--     <button class="btn btn-success" onclick="backCommit()" style="margin:0px 10px">返回订单</button>-->
      <button class="btn btn-danger" onclick="addNew()" style="margin:0px 10px">新增地址</button>
    </div>

  </body>
</html>